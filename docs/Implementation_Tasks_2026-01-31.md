# ClawdBot Gideon Mission Control — Implementation Tasks

**PRD:** `/Users/steveshearman/.windsurf/plans/prd-clawdbot-mission-control-8af232.md`  
**Created:** 2026-01-31  
**Status:** Not Started

---

## Definition of Done (from PRD)

- [ ] All acceptance tests pass for implemented scope
- [ ] Lint (`eslint`) and type-check (`tsc --noEmit`) pass with no errors
- [ ] Build (`next build`) succeeds
- [ ] Manual smoke test on Safari and Chrome (macOS)
- [ ] PWA installable and functional offline for cached assets

---

## 0. Pre-Flight / Prerequisites (generated by agent)

- [x] 0.1 Install Node.js + npm (required for Next.js tooling) [generated by agent]
  - Installed via Homebrew `node@22` and linked (`brew link --force --overwrite node@22`).
  - [x] 0.1.1 Fix Node.js install (brew install node was SIGKILL) [generated by agent]
    - Resolution: use `node@22` (already installed) instead of `node` formula; link fixed missing `node` in PATH.
- [x] 0.2 Install GitHub CLI (`gh`) for repo creation/CI setup [generated by agent]
- [x] 0.3 Authenticate `gh` with GitHub org `aiwith-agency` (required to create private repo) [generated by agent]
- [x] 0.4 Create git repo + GitHub remote repo `TheRebelAI/gideon_mission_control` and push initial commit [generated by agent]
  - Note: org `aiwith-agency` returned 404 from GitHub API; created under `TheRebelAI` instead. Can transfer later.
  - [ ] 0.4.1 (Optional) Transfer repo to org `aiwith-agency` once access/slug is confirmed [generated by agent]

---

## 1. Project Scaffold

### 1.1 Initialize Next.js 14 project with TypeScript
- [x] Run `npx create-next-app@latest` with App Router, TypeScript, Tailwind CSS, ESLint
- [x] Verify `npm run dev` starts successfully
- [x] 1.1.1 Keep Next.js v16 (deviation from PRD Next.js 14) — accepted by Steve on 2026-01-31 [generated by agent]

### 1.2 Install and configure shadcn/ui
- [x] Run `npx shadcn@latest init`
- [x] Configure with default theme (neutral), CSS variables enabled
- [x] Install initial components: `button`, `input`, `card`, `dropdown-menu`, `dialog`, `sonner` (toast replacement)
  - Note: `toast` component is deprecated in shadcn; using `sonner` instead.

### 1.3 Install additional dependencies
- [x] Install `@dnd-kit/core`, `@dnd-kit/sortable`, `@dnd-kit/utilities` for Kanban
- [x] Install `lucide-react` for icons
- [x] Install `next-pwa` for PWA support

### 1.4 Configure PWA basics
- [ ] Create `public/manifest.json` with app name, icons, theme colors
- [ ] Configure `next.config.js` with `next-pwa` wrapper
- [ ] Add placeholder icons (192x192, 512x512)

### 1.5 Establish project structure
- [ ] Create folder structure: `app/`, `components/`, `contexts/`, `lib/`, `types/`
- [ ] Create `types/index.ts` with core type definitions (Task, Idea, AgentStatus, Message)
- [ ] Verify build passes: `npm run build`

---

## 2. Layout Shell & Theme

### 2.1 Create theme provider and toggle
- [ ] Create `components/providers/theme-provider.tsx` using `next-themes`
- [ ] Install `next-themes` package
- [ ] Create `components/ui/theme-toggle.tsx` with light/dark/system options
- [ ] Default to system preference (FR-6.1)

### 2.2 Define color palette
- [ ] Configure Tailwind `tailwind.config.ts` with Obsidian/Linear palette:
  - Dark grays: `#1e1e1e`, `#2d2d2d`
  - Accents: blue `#5c7cfa`, green `#40c057`, yellow `#fab005`, red `#fa5252`
- [ ] Verify dark/light modes render correctly

### 2.3 Build main layout shell
- [ ] Create `app/layout.tsx` with ThemeProvider, base HTML structure
- [ ] Create `components/layout/header.tsx` with:
  - Top-left: placeholder for status indicator
  - Top-right: theme toggle
- [ ] Create `components/layout/main-content.tsx` as container for Kanban
- [ ] Create `components/layout/chat-panel.tsx` placeholder (collapsible right panel)
- [ ] Verify responsive layout on desktop/tablet viewports

### 2.4 Write layout tests
- [ ] Write E2E test: theme toggle switches between light/dark modes (FR-6.1)
- [ ] Verify test passes

---

## 3. Status Indicator & Model Selector

### 3.1 Create AgentContext
- [ ] Create `contexts/agent-context.tsx` with:
  - `status`: 'idle' | 'thinking' | 'active' | 'resting'
  - `currentModel`: string
  - `modelList`: string[]
  - `setStatus`, `setCurrentModel` actions
- [ ] Provide mock initial values

### 3.2 Build status indicator component
- [ ] Create `components/agent/status-indicator.tsx`
- [ ] Implement color coding: idle (gray), thinking (pulsing yellow), active (green), resting (red) (FR-1.1)
- [ ] Implement pulsing animation for 'thinking' and 'active' states (FR-1.2)
- [ ] Display current model name beneath indicator (FR-1.3)

### 3.3 Build model selector dropdown
- [ ] Create `components/agent/model-selector.tsx` using shadcn `dropdown-menu`
- [ ] List available models from context (FR-2.1)
- [ ] On selection, dispatch model change (wire to chat in Section 4) (FR-2.2)

### 3.4 Integrate into header
- [ ] Add StatusIndicator and ModelSelector to header layout
- [ ] Verify visual appearance matches Obsidian/Linear aesthetic

### 3.5 Write status indicator tests
- [ ] Write unit test: status indicator renders correct color for each state (FR-1.1)
- [ ] Write visual/E2E test: pulsing animation visible for thinking/active (FR-1.2)
- [ ] Verify tests pass

---

## 4. Chat Interface

### 4.1 Create ChatContext
- [ ] Create `contexts/chat-context.tsx` with:
  - `messages`: Message[]
  - `isStreaming`: boolean
  - `addMessage`, `appendToLastMessage`, `setStreaming` actions
- [ ] Define Message type: `{ id, role: 'user' | 'assistant', content, timestamp }`

### 4.2 Build chat panel UI
- [ ] Create `components/chat/chat-panel.tsx` (collapsible side panel) (FR-3.1)
- [ ] Create `components/chat/message-list.tsx` displaying message history
- [ ] Create `components/chat/message-bubble.tsx` with distinct user/agent styling (FR-3.2)
- [ ] Create `components/chat/chat-input.tsx` with text input and send button (FR-3.3)

### 4.3 Implement API integration with SSE streaming
- [ ] Create `lib/api/chat.ts` with `sendMessage()` function
- [ ] Connect to `POST http://127.0.0.1:18789/v1/chat/completions` (FR-3.4)
- [ ] Implement SSE streaming parser for `stream: true` responses (FR-3.5)
- [ ] Handle connection errors gracefully (toast notification, retry option)

### 4.4 Create Next.js API route proxy (CORS fallback)
- [ ] Create `app/api/chat/route.ts` as proxy to ClawdBot API
- [ ] Support streaming responses through the proxy
- [ ] Add environment variable for API token (do not hardcode)

### 4.5 Wire model selector to chat
- [ ] When model is selected, send chat message instructing agent to swap models (FR-2.2)
- [ ] Update displayed model name after successful swap (FR-2.3)

### 4.6 Write chat tests
- [ ] Write integration test: chat sends request and receives response (FR-3.4)
- [ ] Write integration test: streaming tokens render incrementally (FR-3.5)
- [ ] Verify tests pass

---

## 5. Kanban Board

### 5.1 Create TaskContext
- [ ] Create `contexts/task-context.tsx` with:
  - `tasks`: Task[]
  - `addTask`, `updateTask`, `deleteTask`, `moveTask` actions
- [ ] Define Task type: `{ id, title, description?, column, createdAt, updatedAt }`
- [ ] Define columns: 'backlog' | 'todo' | 'in-progress' | 'review' | 'done'

### 5.2 Implement localStorage persistence
- [ ] Create `lib/storage/tasks.ts` with load/save functions
- [ ] Initialize TaskContext from localStorage on mount
- [ ] Persist on every state change (FR-4.5)

### 5.3 Build Kanban board structure
- [ ] Create `components/kanban/kanban-board.tsx` as main container
- [ ] Create `components/kanban/kanban-column.tsx` for each column (FR-4.1)
- [ ] Create `components/kanban/task-card.tsx` for individual tasks

### 5.4 Implement drag-and-drop with @dnd-kit
- [ ] Set up DndContext in kanban-board
- [ ] Make columns droppable with `useDroppable`
- [ ] Make task cards draggable with `useDraggable` or `useSortable`
- [ ] Handle `onDragEnd` to move tasks between columns (FR-4.2)
- [ ] Ensure empty columns remain visible as drop zones

### 5.5 Implement task CRUD
- [ ] Create `components/kanban/add-task-dialog.tsx` for new tasks (FR-4.3)
- [ ] Implement inline edit mode on task cards (FR-4.4)
- [ ] Add delete confirmation and action (FR-4.4)
- [ ] Handle long titles (truncate with tooltip/expand)

### 5.6 Write Kanban tests
- [ ] Write E2E test: task card can be dragged between columns (FR-4.2)
- [ ] Write integration test: tasks persist across page reload (FR-4.5)
- [ ] Verify tests pass

---

## 6. Ideas Backlog

### 6.1 Extend TaskContext for ideas
- [ ] Add `ideas`: Idea[] to TaskContext
- [ ] Define Idea type: `{ id, content, createdAt }`
- [ ] Add `addIdea`, `deleteIdea`, `promoteIdea` actions
- [ ] Persist ideas to localStorage (FR-5.4)

### 6.2 Build Ideas UI
- [ ] Create `components/ideas/ideas-panel.tsx` as separate section/tab (FR-5.1)
- [ ] Create `components/ideas/idea-item.tsx` for individual ideas
- [ ] Create quick-add input at top of panel (FR-5.2)

### 6.3 Implement promote to task
- [ ] Add "Promote to Task" action on each idea (FR-5.3)
- [ ] On promote: remove from ideas, create task in Kanban 'backlog' column
- [ ] Show confirmation or toast on successful promotion

### 6.4 Integrate Ideas into layout
- [ ] Add tab or toggle to switch between Kanban and Ideas views
- [ ] Or: show Ideas as a collapsible sidebar/section

### 6.5 Write Ideas tests
- [ ] Write unit test: promoting an idea removes it from Ideas (FR-5.3)
- [ ] Write E2E test: promoting adds task to Kanban Backlog (FR-5.3)
- [ ] Verify tests pass

---

## 7. Polish & PWA Finalization

### 7.1 Animations and micro-interactions
- [ ] Add subtle transitions on hover/focus states
- [ ] Smooth drag-and-drop animations
- [ ] Loading states for chat streaming

### 7.2 Accessibility audit
- [ ] Ensure keyboard navigation for all interactive elements
- [ ] Add appropriate ARIA labels
- [ ] Test with screen reader (VoiceOver)

### 7.3 Mobile/tablet refinements
- [ ] Test responsive layout on smaller viewports
- [ ] Adjust chat panel behavior (full-screen modal on mobile?)
- [ ] Ensure touch-friendly tap targets

### 7.4 PWA finalization
- [ ] Create proper app icons (192x192, 512x512)
- [ ] Verify manifest.json is complete (FR-7.1)
- [ ] Test service worker caches static assets (FR-7.2)
- [ ] Test "Add to Home Screen" on Chrome desktop (FR-7.3)
- [ ] Run Lighthouse PWA audit, target score > 90

### 7.5 Final validation
- [ ] Run full test suite
- [ ] Run `eslint` — no errors
- [ ] Run `tsc --noEmit` — no errors
- [ ] Run `npm run build` — succeeds
- [ ] Manual smoke test on Safari (macOS)
- [ ] Manual smoke test on Chrome (macOS)

---

## Notes / Changes

_Record any scope changes, discoveries, or deferred items here._

---

## Open Questions (from PRD)

1. **Model list:** What models should appear in the dropdown? → *Start with placeholder list; update when confirmed*
2. **Agent status source:** API endpoint to poll, or infer from chat? → *Mock initially; wire later*
3. **Chat history persistence:** localStorage or fresh each session? → *Default: persist in localStorage; can add clear option*
